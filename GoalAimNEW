package org.firstinspires.ftc.teamcode.pedroPathing;

import static org.firstinspires.ftc.teamcode.pedroPathing.Tuning.follower;
import com.pedropathing.util.MathFunctions;

public class GoalAimVelocity {

    private final double redGoalPoseY = 144.0;
    private final double redGoalPoseX = 144.0;

  
    public double getDistance() {

        if (follower == null || follower.getPose() == null) {
            return 0.0;
        }

        return Math.sqrt(
                Math.pow(redGoalPoseY - follower.getPose().getY(), 2) +
                        Math.pow(redGoalPoseX - follower.getPose().getX(), 2)
        );
    }

    private double getAngleToGoal() {
        return Math.atan2(
                redGoalPoseY - follower.getPose().getY(),
                redGoalPoseX - follower.getPose().getX()
        );
    }

    public double autoAim() {

        if (follower == null || follower.getPose() == null) {
            return 0.0;
        }

        double goalAngleDeg = Math.toDegrees(getAngleToGoal());
        double angleDeg = follower.getHeading() - goalAngleDeg;

        return MathFunctions.angleWrap(angleDeg);
    }


    public double getTargetVel() {

        if (follower == null || follower.getPose() == null) {
            return 0.0;
        }

        double dis = getDistance();

        return MathFunctions.clamp
                (0.0246153 * Math.pow(dis, 2) + 1.69857 * dis + 747.19611, 0, 1500);
    }
}
